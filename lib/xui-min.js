(function(){var _$=function(els){this.elements=[];var size=els.length;for(var i=0;i<size;i++){var element=els[i];if(typeof element=="string"){var element=document.querySelectorAll(element);var len=element.length;for(var x=0;x<len;x++){this.elements.push(element[x])}}else{this.elements.push(element)}}return this};_$.prototype={first:function(){return this.elements[0]},each:function(fn){for(var i=0,len=this.elements.length;i<len;++i){fn.call(this,this.elements[i])}return this},merge:function(libObj){for(var x in libObj){this[x]=libObj[x]}}};var xui=window.x$=function(){var Dom={clean:function(){var ns=/\S/;this.each(function(el){var d=el,n=d.firstChild,ni=-1;while(n){var nx=n.nextSibling;if(n.nodeType==3&&!ns.test(n.nodeValue)){d.removeChild(n)}else{n.nodeIndex=++ni}n=nx}});return this},html:function(html,loc){var that=this;this.clean();var loc=(loc!=null)?loc:"inner";this.each(function(el){switch(loc){case"inner":el.innerHTML=html;break;case"outer":if(typeof html=="string"){html=this.wrap(html,this.getTag(el))}el.parentNode.replaceChild(html,el);break;case"top":if(typeof html=="string"){html=this.wrap(html,this.getTag(el))}el.insertBefore(html,el.firstChild);break;case"bottom":if(typeof html=="string"){html=this.wrap(html,this.getTag(el))}el.insertBefore(html,null);break}});return this},wrap:function(html,tag){var attributes={};var re=/^<([A-Z][A-Z0-9]*)(.*)[^>]*>(.*?)<\/\1>/i;if(re.test(html)){result=re.exec(html);tag=result[1];if(result[2]!=""){var attre=/([a-zA-Z]*\s*=\s*['|"][a-zA-Z0-9:;#\s]*['|"])/;attrList=result[2].split(attre);for(var i=0;i<attrList.length;i++){if(attrList[i]!=""&&attrList[i]!=" "){var node=attrList[i].split("=");attributes[node[0]];attributes[node[0]]=node[1].replace(/(["']?)/g,"")}}}html=result[3]}var element=document.createElement(tag);element.innerHTML=html;for(var i in attributes){var a=document.createAttribute(i);a.nodeValue=attributes[i];element.setAttributeNode(a)}return element},getTag:function(el){if(el.firstChild==null){switch(el.tagName){case"UL":return"LI";break;case"DL":return"DT";break;case"TR":return"TD";break}}return el.firstChild.tagName}};var Event={eventfunctions:[],click:function(fn){return this.on("click",fn)},load:function(fn){return this.on("load",fn)},on:function(type,fn){var listen=function(el){if(window.addEventListener){el.addEventListener(type,fn,false)}};this.each(function(el){listen(el)});return this},subscribe:function(fn){this.eventfunctions.push(fn)},unsubscribe:function(fn){this.eventfunctions=this.eventfunctions.filter(function(el){if(el!==fn){return el}})},fire:function(o,thisObj){var scope=thisObj||window;this.eventfunctions.forEach(function(el){el.call(scope,o)})},stop:function(e){if(window.event&&window.event.returnValue){window.event.returnValue=false}if(e&&e.preventDefault){e.preventDefault()}},bind:function(fn,context){var args=[];for(var i=2;i<arguments.length;i++){args[i-2]=arguments[i]}fn.apply(context,args);return this}};var Style={setStyle:function(prop,val){this.each(function(el){el.style[prop]=val});return this},getStyle:function(prop,callback){var that=this;this.each(function(el){var strValue=document.defaultView.getComputedStyle(el,"").getPropertyValue(prop);if(typeof callback=="function"){callback(strValue)}else{that=strValue}});return that},addClass:function(className){this.each(function(el){if(this.hasClass(el,className)==false){el.className+=" "+className}});return this},removeClass:function(className){var re=this.getClassRegEx(className);this.each(function(el){el.className=el.className.replace(re," ")});return this},css:function(o){var that=this;this.each(function(el){for(var prop in o){that.setStyle(prop,o[prop])}});return this||that},reClassNameCache:{},getClassRegEx:function(className){var re=this.reClassNameCache[className];if(!re){re=new RegExp("(?:^|\\s+)"+className+"(?:\\s+|$)");this.reClassNameCache[className]=re}return re},hasClass:function(el,className){var re=this.getClassRegEx(className);return re.test(el.className)}};var Fx={animationStack:[],tween:function(options){if(options instanceof Array){for(var i=0;i<options.length;i++){this.animationStack.push(options[i])}}else{if(options instanceof Object){this.animationStack.push(options)}}this.start();return this},start:function(){var t=0;for(var i=0;i<this.animationStack.length;i++){var options=this.animationStack[i];var duration=options.duration==undefined?0.5:options.duration;setTimeout(function(s,o){s.animate(o)},t*1000*duration,this,options);t+=duration}return this},animate:function(options){var that=this;var opt_after=options.after;var easing=(options.easing==undefined)?"ease-in":options.easing;var before=(options.before==undefined)?function(){}:options.before;var after=(opt_after==undefined)?function(){}:function(){opt_after.apply(that)};var duration=(options.duration==undefined)?0.5:options.duration;options.easing=options.before=options.after=options.duration=undefined;before.apply(before.arguments);this.setStyle("-webkit-transition","all "+duration+"s "+easing);this.each(function(el){for(var prop in options){that.setStyle(prop,options[prop])}});setTimeout(function(){that.setStyle("-webkit-transition","none")},duration*1000);setTimeout(after,duration*1000);return this||that}};var Xhr={xhr:function(url,options){if(options==undefined){var options={}}var that=this;var req=new XMLHttpRequest();var method=options.method||"get";var async=options.async||false;var params=options.data||null;req.open(method,url,async);req.onload=(options.callback!=null)?options.callback:function(){that.html(this.responseText)};req.send(params);return this},xhrjson:function(url,options){if(options==undefined){return this}var that=this;var cb=options.callback;if(typeof cb!="function"){var cb=function(x){return x}}var callback=function(){var o=eval("("+this.responseText+")");for(var prop in o){x$(options.map[prop]).html(cb(o[prop]))}};options.callback=callback;this.xhr(url,options);return this},xhrForm:function(){var that=this;this.each(function(e){if(e.tagName=="FORM"){var options={};options.method=e.method;options.data="one=two";that.xhr(e.action,options)}});return this}};var libs=[Dom,Event,Style,Fx,Xhr];var size=libs.length;var that=new _$(arguments);for(var i=0;i<size;i++){that.merge(libs[i])}return that}})();